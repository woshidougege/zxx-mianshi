<h2>ğŸ¤– è‡ªåŠ¨åŒ–æµ‹è¯•</h2>

<h3>æ¥å£è‡ªåŠ¨åŒ–æ¡†æ¶</h3>

<div class="highlight-box">
    <h4>Python + requests + pytest æ¡†æ¶</h4>
    <p><strong>æ¡†æ¶ç»“æ„ï¼š</strong></p>
    <pre><code>project/
â”œâ”€â”€ config/           # é…ç½®æ–‡ä»¶ï¼ˆç¯å¢ƒã€æ•°æ®åº“ç­‰ï¼‰
â”œâ”€â”€ test_cases/       # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ common/           # å…¬å…±æ–¹æ³•ï¼ˆè¯·æ±‚å°è£…ã€æ•°æ®åº“æ“ä½œç­‰ï¼‰
â”œâ”€â”€ data/             # æµ‹è¯•æ•°æ®
â”œâ”€â”€ logs/             # æ—¥å¿—
â””â”€â”€ reports/          # æµ‹è¯•æŠ¥å‘Š</code></pre>
</div>

<div class="tech-box">
    <h4>åŸºç¡€ç¤ºä¾‹ä»£ç </h4>
    <pre><code># test_login.py
import requests
import pytest

class TestLogin:
    base_url = "https://api.example.com"
    
    def test_login_success(self):
        """æµ‹è¯•æ­£å¸¸ç™»å½•"""
        url = f"{self.base_url}/login"
        data = {
            "username": "test",
            "password": "123456"
        }
        response = requests.post(url, json=data)
        
        # æ–­è¨€
        assert response.status_code == 200
        assert response.json()["code"] == 0
        assert "token" in response.json()["data"]
    
    def test_login_wrong_password(self):
        """æµ‹è¯•é”™è¯¯å¯†ç """
        url = f"{self.base_url}/login"
        data = {
            "username": "test",
            "password": "wrong"
        }
        response = requests.post(url, json=data)
        
        assert response.status_code == 200
        assert response.json()["code"] == 1001
        assert "å¯†ç é”™è¯¯" in response.json()["msg"]
    
    @pytest.mark.parametrize("username,password,expected_code", [
        ("", "123456", 1002),  # ç”¨æˆ·åä¸ºç©º
        ("test", "", 1003),    # å¯†ç ä¸ºç©º
        ("", "", 1002),         # éƒ½ä¸ºç©º
    ])
    def test_login_params(self, username, password, expected_code):
        """å‚æ•°åŒ–æµ‹è¯•"""
        url = f"{self.base_url}/login"
        data = {
            "username": username,
            "password": password
        }
        response = requests.post(url, json=data)
        assert response.json()["code"] == expected_code</code></pre>
</div>

<hr>

<h3>pytestæ ¸å¿ƒåŠŸèƒ½</h3>

<div class="example-box">
    <h4>1. fixture - æµ‹è¯•å‰åå¤„ç†</h4>
    <pre><code>import pytest

@pytest.fixture(scope="function")
def login():
    """æ¯ä¸ªæµ‹è¯•å‰ç™»å½•"""
    print("æ‰§è¡Œç™»å½•")
    token = "test_token_123"
    yield token  # è¿”å›ç»™æµ‹è¯•ç”¨ä¾‹
    print("æµ‹è¯•ç»“æŸï¼Œæ¸…ç†æ•°æ®")

def test_get_user_info(login):
    """ä½¿ç”¨fixture"""
    token = login
    # ä½¿ç”¨tokenè°ƒç”¨æ¥å£
    print(f"ä½¿ç”¨token: {token}")</code></pre>
    
    <p><strong>scopeå‚æ•°ï¼š</strong></p>
    <ul>
        <li><code>function</code>: æ¯ä¸ªæµ‹è¯•å‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼ˆé»˜è®¤ï¼‰</li>
        <li><code>class</code>: æ¯ä¸ªæµ‹è¯•ç±»æ‰§è¡Œä¸€æ¬¡</li>
        <li><code>module</code>: æ¯ä¸ªæ¨¡å—æ‰§è¡Œä¸€æ¬¡</li>
        <li><code>session</code>: æ•´ä¸ªæµ‹è¯•ä¼šè¯æ‰§è¡Œä¸€æ¬¡</li>
    </ul>
</div>

<div class="example-box">
    <h4>2. conftest.py - å…±äº«é…ç½®</h4>
    <pre><code># conftest.py
import pytest

@pytest.fixture(scope="session")
def base_url():
    """å…¨å±€é…ç½®"""
    return "https://api.example.com"

@pytest.fixture(scope="session")
def admin_token():
    """ç®¡ç†å‘˜token"""
    # æ‰§è¡Œç™»å½•è·å–token
    return "admin_token_abc"</code></pre>
</div>

<div class="example-box">
    <h4>3. å‚æ•°åŒ–æµ‹è¯•</h4>
    <pre><code>import pytest

@pytest.mark.parametrize("age,expected", [
    (0, False),    # è¾¹ç•Œå€¼-1
    (1, True),     # æœ€å°å€¼
    (60, True),    # ä¸­é—´å€¼
    (120, True),   # æœ€å¤§å€¼
    (121, False),  # è¾¹ç•Œå€¼+1
])
def test_age_validation(age, expected):
    result = validate_age(age)
    assert result == expected</code></pre>
</div>

<hr>

<h3>æ•°æ®é©±åŠ¨æµ‹è¯•</h3>

<div class="tech-box">
    <h4>ä½¿ç”¨Excel/CSVç®¡ç†æµ‹è¯•æ•°æ®</h4>
    <pre><code># test_data.csv
username,password,expected_code,expected_msg
test1,123456,0,ç™»å½•æˆåŠŸ
test2,wrong,1001,å¯†ç é”™è¯¯
,,1002,ç”¨æˆ·åä¸èƒ½ä¸ºç©º

# test_login_data_driven.py
import pytest
import csv

def load_test_data():
    """è¯»å–æµ‹è¯•æ•°æ®"""
    with open('test_data.csv', 'r', encoding='utf-8') as f:
        reader = csv.DictReader(f)
        return list(reader)

@pytest.mark.parametrize("case", load_test_data())
def test_login_from_csv(case):
    """æ•°æ®é©±åŠ¨æµ‹è¯•"""
    response = login(case['username'], case['password'])
    assert response['code'] == int(case['expected_code'])
    assert case['expected_msg'] in response['msg']</code></pre>
</div>

<hr>

<h3>CI/CDé›†æˆ</h3>

<div class="highlight-box">
    <h4>Jenkins Pipelineé›†æˆ</h4>
    <pre><code>pipeline {
    agent any
    
    stages {
        stage('æ‹‰å–ä»£ç ') {
            steps {
                git 'https://github.com/xxx/test-project.git'
            }
        }
        
        stage('å®‰è£…ä¾èµ–') {
            steps {
                sh 'pip install -r requirements.txt'
            }
        }
        
        stage('æ‰§è¡Œæµ‹è¯•') {
            steps {
                sh 'pytest --alluredir=./allure-results'
            }
        }
        
        stage('ç”ŸæˆæŠ¥å‘Š') {
            steps {
                allure includeProperties: false,
                       jdk: '',
                       results: [[path: 'allure-results']]
            }
        }
        
        stage('å‘é€é€šçŸ¥') {
            steps {
                emailext body: 'æµ‹è¯•å®Œæˆï¼ŒæŸ¥çœ‹æŠ¥å‘Š',
                         subject: 'è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Š',
                         to: 'test@example.com'
            }
        }
    }
}</code></pre>
</div>

<hr>

<h3>è´¨é‡é—¨ç¦è®¾ç½®</h3>

<div class="tech-box">
    <h4>å‡†å…¥å‡†å‡ºæ ‡å‡†</h4>
    <table>
        <tr>
            <th>é˜¶æ®µ</th>
            <th>æ£€æŸ¥é¡¹</th>
            <th>æ ‡å‡†</th>
        </tr>
        <tr>
            <td rowspan="3">å‡†å…¥ï¼ˆä»£ç æäº¤å‰ï¼‰</td>
            <td>å†’çƒŸç”¨ä¾‹é€šè¿‡ç‡</td>
            <td>100%</td>
        </tr>
        <tr>
            <td>æ ¸å¿ƒæ¥å£é€šè¿‡ç‡</td>
            <td>100%</td>
        </tr>
        <tr>
            <td>æ‰§è¡Œæ—¶é—´</td>
            <td>&lt; 5åˆ†é’Ÿ</td>
        </tr>
        <tr>
            <td rowspan="4">å‡†å‡ºï¼ˆå‘å¸ƒå‰ï¼‰</td>
            <td>å…¨é‡ç”¨ä¾‹é€šè¿‡ç‡</td>
            <td>â‰¥ 95%</td>
        </tr>
        <tr>
            <td>P0/P1 Bugæ•°é‡</td>
            <td>0ä¸ª</td>
        </tr>
        <tr>
            <td>ç”¨ä¾‹è¦†ç›–ç‡</td>
            <td>â‰¥ 80%</td>
        </tr>
        <tr>
            <td>æ‰§è¡Œæ—¶é—´</td>
            <td>&lt; 30åˆ†é’Ÿ</td>
        </tr>
    </table>
</div>

<hr>

<h3>è‡ªåŠ¨åŒ–æµ‹è¯•æœ€ä½³å®è·µ</h3>

<div class="example-box">
    <h4>âœ… æ¨èåšæ³•</h4>
    <ul>
        <li><strong>åˆ†å±‚æµ‹è¯•ï¼š</strong>æ¥å£è‡ªåŠ¨åŒ–ä¸ºä¸»ï¼ˆ70%ï¼‰ã€UIè‡ªåŠ¨åŒ–ä¸ºè¾…ï¼ˆ30%ï¼‰</li>
        <li><strong>ç¨³å®šä¼˜å…ˆï¼š</strong>ä¼˜å…ˆè‡ªåŠ¨åŒ–ç¨³å®šçš„åŠŸèƒ½</li>
        <li><strong>ç‹¬ç«‹æ€§ï¼š</strong>æµ‹è¯•ç”¨ä¾‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¾èµ–æ‰§è¡Œé¡ºåº</li>
        <li><strong>å¯è¯»æ€§ï¼š</strong>ä»£ç æ¸…æ™°ï¼Œå‘½åè§„èŒƒï¼Œæ³¨é‡Šå®Œæ•´</li>
        <li><strong>å¯ç»´æŠ¤æ€§ï¼š</strong>å‚æ•°åŒ–ã€é…ç½®åŒ–ï¼Œå‡å°‘hardcode</li>
        <li><strong>å¿«é€Ÿåé¦ˆï¼š</strong>å†’çƒŸç”¨ä¾‹å¿«é€Ÿæ‰§è¡Œï¼ˆ5åˆ†é’Ÿå†…ï¼‰</li>
        <li><strong>å¤±è´¥é‡è¯•ï¼š</strong>ç½‘ç»œä¸ç¨³å®šçš„ç”¨ä¾‹å¯ä»¥é‡è¯•1-2æ¬¡</li>
        <li><strong>æ—¥å¿—è¯¦ç»†ï¼š</strong>è®°å½•è¯·æ±‚ã€å“åº”ã€æ–­è¨€ç»“æœ</li>
    </ul>
</div>

<div class="warning-box">
    <h4>âŒ é¿å…çš„é—®é¢˜</h4>
    <ul>
        <li><strong>è¿‡åº¦è‡ªåŠ¨åŒ–ï¼š</strong>UIé¢‘ç¹å˜åŠ¨çš„é¡µé¢ä¸é€‚åˆè‡ªåŠ¨åŒ–</li>
        <li><strong>ç”¨ä¾‹ä¾èµ–ï¼š</strong>æµ‹è¯•Aä¾èµ–æµ‹è¯•Bçš„æ•°æ®ï¼ŒAå¤±è´¥Bä¹Ÿå¤±è´¥</li>
        <li><strong>æ–­è¨€ä¸è¶³ï¼š</strong>åªéªŒè¯çŠ¶æ€ç ï¼Œä¸éªŒè¯ä¸šåŠ¡æ•°æ®</li>
        <li><strong>ç¡¬ç¼–ç ï¼š</strong>ç¯å¢ƒã€æ•°æ®å†™æ­»åœ¨ä»£ç é‡Œ</li>
        <li><strong>å¿½ç•¥ç»´æŠ¤ï¼š</strong>æ¥å£å˜æ›´ä¸åŠæ—¶æ›´æ–°ç”¨ä¾‹</li>
        <li><strong>å¿½ç•¥æŠ¥å‘Šï¼š</strong>æ‰§è¡Œå®Œä¸çœ‹æŠ¥å‘Šï¼Œå¤±è´¥ä¹Ÿä¸ç®¡</li>
    </ul>
</div>

<hr>

<h3>è‡ªåŠ¨åŒ–æµ‹è¯•ROIè®¡ç®—</h3>

<div class="tech-box">
    <p><strong>æŠ•å…¥æˆæœ¬ï¼š</strong></p>
    <ul>
        <li>è„šæœ¬å¼€å‘æ—¶é—´ï¼šå‡è®¾100ä¸ªç”¨ä¾‹ï¼Œæ¯ä¸ª30åˆ†é’Ÿ = 50å°æ—¶</li>
        <li>è„šæœ¬ç»´æŠ¤æ—¶é—´ï¼šæ¯æœˆ10å°æ—¶</li>
    </ul>
    
    <p><strong>èŠ‚çœæˆæœ¬ï¼š</strong></p>
    <ul>
        <li>æ‰‹å·¥æ‰§è¡Œæ—¶é—´ï¼šæ¯æ¬¡å›å½’100ä¸ªç”¨ä¾‹ï¼Œéœ€è¦2å¤©ï¼ˆ16å°æ—¶ï¼‰</li>
        <li>å›å½’é¢‘ç‡ï¼šæ¯å‘¨1æ¬¡ï¼Œä¸€å¹´52æ¬¡</li>
        <li>å¹´èŠ‚çœæ—¶é—´ï¼š52 Ã— 16 = 832å°æ—¶</li>
    </ul>
    
    <p><strong>ROIåˆ†æï¼š</strong></p>
    <ul>
        <li>ç¬¬1å¹´ï¼šèŠ‚çœ832å°æ—¶ - æŠ•å…¥50å°æ—¶ - ç»´æŠ¤120å°æ—¶ = 662å°æ—¶</li>
        <li>ç¬¬2å¹´ï¼šèŠ‚çœ832å°æ—¶ - ç»´æŠ¤120å°æ—¶ = 712å°æ—¶</li>
        <li>æŠ•èµ„å›æŠ¥ç‡ï¼šç¬¬1å¹´å°±å›æœ¬ï¼Œç¬¬2å¹´æ”¶ç›Šæ›´é«˜</li>
    </ul>
</div>

